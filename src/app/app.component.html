<div class="app-container">
  <!-- En-tête -->
  <header class="app-header">
    <div class="header-left">
      <h1>
        <i class="fas fa-file-pdf text-danger"></i>
        PDF Editor Advanced
      </h1>
      <div class="document-info" *ngIf="pdfFile">
        <span class="document-name">{{ currentDocument.name }}</span>
        <span class="document-stats">
          <i class="fas fa-layer-group"></i>
          {{ currentDocument.fields.length }} éléments
        </span>
      </div>
    </div>

    <div class="header-right">
      <div class="file-upload">
        <input 
          type="file" 
          id="pdfInput" 
          accept=".pdf"
          (change)="onFileSelected($event)"
          hidden>
        <label for="pdfInput" class="btn-upload">
          <i class="fas fa-upload"></i>
          Charger un PDF
        </label>
        <span *ngIf="pdfFile" class="file-name">
          {{ pdfFile.name }}
        </span>
      </div>
    </div>
  </header>

  <!-- Barre d'outils principale -->
  <app-pdf-toolbar
    [canUndo]="canUndo"
    [canRedo]="canRedo"
    [totalPages]="totalPages"
    [currentPage]="currentDocument.currentPage"
    [showTextProperties]="activeTool === 'text'"
    [textProperties]="textProperties"
    (toolSelected)="onToolSelected($event)"
    (undo)="onUndo()"
    (redo)="onRedo()"
    (export)="onExport()"
    (save)="onSave()"
    (load)="onLoad()"
    (clear)="onClear()"
    (pageChange)="onPageChange($event)"
    (textPropertiesChange)="onTextPropertiesChange($event)">
  </app-pdf-toolbar>

  <!-- Zone de contenu principale -->
  <main class="app-main">
    <!-- Viewer PDF -->
    <div class="pdf-viewer-wrapper" *ngIf="pdfUrl">
      <app-pdf-viewer
        [pdfUrl]="pdfUrl"
        [currentPage]="currentDocument.currentPage"
        [fields]="currentDocument.fields"
        [scale]="scale"
        [activeTool]="activeTool"
        (pageClick)="onPageClick($event)"
        (fieldAdded)="onFieldUpdated($event)"
        (fieldUpdated)="onFieldUpdated($event)"
        (fieldSelected)="onFieldSelected($event)"
        (pageRendered)="onPageRendered($event)">
      </app-pdf-viewer>
    </div>

    <!-- État vide -->
    <div class="empty-state" *ngIf="!pdfUrl">
      <div class="empty-content">
        <i class="fas fa-file-pdf"></i>
        <h2>Aucun PDF chargé</h2>
        <p>Chargez un fichier PDF pour commencer l'édition</p>
        <div class="file-upload-large">
          <input 
            type="file" 
            id="pdfInputLarge" 
            accept=".pdf"
            (change)="onFileSelected($event)"
            hidden>
          <label for="pdfInputLarge" class="btn-upload-large">
            <i class="fas fa-cloud-upload-alt"></i>
            <span>Choisir un fichier PDF</span>
            <small>ou glissez-déposez ici</small>
          </label>
        </div>
      </div>
    </div>
  </main>

  <!-- Panneau de signature -->
  <app-signature-pad
    *ngIf="showSignaturePad"
    (signatureSaved)="onSignatureSaved($event)"
    (closed)="onCloseSignaturePad()">
  </app-signature-pad>

  <!-- Panneau des documents sauvegardés -->
  <app-saved-documents
    [show]="showSavedDocuments"
    (closed)="onCloseSavedDocuments()"
    (documentSelected)="loadSavedDocument($event)">
  </app-saved-documents>

  <!-- Pied de page -->
  <footer class="app-footer">
    <div class="footer-content">
      <p>
        <i class="fas fa-info-circle"></i>
        PDF Editor Advanced v1.0 - Glissez-déposez, Undo/Redo, Multi-pages
      </p>
      <div class="footer-stats" *ngIf="pdfFile">
        <span class="stat">
          <i class="fas fa-file-alt"></i>
          Page {{ currentDocument.currentPage }}/{{ totalPages }}
        </span>
        <span class="stat">
          <i class="fas fa-object-group"></i>
          {{ currentDocument.fields.length }} éléments
        </span>
        <span class="stat">
          <i class="fas fa-history"></i>
          {{ historyService.getHistory().past.length }} actions
        </span>
      </div>
    </div>
  </footer>
</div>
